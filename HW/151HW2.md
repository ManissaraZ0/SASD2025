# HW2: Code Smell - Comments

## ความหมายของ Code Smell ประเภท Comments

**Comments Code Smell** หมายถึง การใช้คอมเมนต์มากเกินความจำเป็น หรือใช้คอมเมนต์เพื่ออธิบายว่าโค้ดทำอะไร แทนที่โค้ดจะสามารถสื่อความหมายได้ด้วยตัวเองผ่านการตั้งชื่อตัวแปร ฟังก์ชัน หรือโครงสร้างโค้ดที่เหมาะสม

ในหนังสือ [*Refactoring*](https://martinfowler.com/books/refactoring.html) ของ Martin Fowler และ Kent Beck ได้กล่าวไว้ว่า 
> หากรู้สึกจำเป็นต้องเขียนคอมเมนต์ ควรพิจารณารีแฟคเตอร์โค้ดให้เข้าใจง่ายด้วยตัวมันเองก่อน 

การมีคอมเมนต์จำนวนมากจึงสะท้อนว่าโค้ดอ่านยาก เข้าใจยาก และขาดความชัดเจน ซึ่งถูกจัดเป็นหนึ่งใน code smells

## ตัวอย่างโค้ดที่เกิด Comments Code Smell และโค้ดที่ Refactoring แล้ว

### การคอมเมนต์อธิบายทุกบรรทัด

```csharp
// คำนวณผลรวมราคาสินค้าทั้งหมด
double total = 0;

// วนลูปผ่านรายการสินค้า
for (int i = 0; i < items.Count; i++)
{
    // คูณจำนวนกับราคาแล้วบวกเข้า total
    total += quantities[i] * prices[i];
}

// คืนค่าผลรวม
return total;
```
โค้ดตัวอย่างนี้ใช้คอมเมนต์อธิบายสิ่งที่โค้ดสามารถสื่อได้อยู่แล้ว ซึ่งแสดงให้เห็นว่าคอมเมนต์เหล่านี้ไม่จำเป็น และควรปรับปรุงโค้ดให้สื่อความหมายได้ด้วยตัวเอง

### Refactoring โดยการ Extract Method และตั้งชื่อเมธอดให้ชัดเจน
```C#
double CalculateTotalPrice(IList<Item> items, IList<int> quantities, IList<double> prices) {
    double totalPrice = 0;

    for (int i = 0; i < items.Count; i++)
    {
        totalPrice += quantities[i] * prices[i];
    }

    return totalPrice;
}
```
หลังจาก refactoring โค้ดสามารถอธิบายหน้าที่ของตัวเองได้ผ่านชื่อเมธอดและตัวแปร โดยไม่จำเป็นต้องใช้คอมเมนต์เพิ่มเติม ทำให้โค้ดอ่านง่ายและดูแลรักษาได้ดียิ่งขึ้น

## กรณีที่ Comments ไม่ได้บ่งบอกถึงปัญหา (ไม่จำเป็นต้อง Refactoring)

ถึงแม้ว่า comments จะถูกจัดเป็น code smell แต่ไม่ใช่ทุกกรณีที่จำเป็นต้องลบหรือ refactor โดยเฉพาะในกรณีต่อไปนี้
* คอมเมนต์ที่อธิบายเหตุผลเบื้องหลัง ของการออกแบบหรือการตัดสินใจ
* คอมเมนต์ที่ใช้ในการอธิบายอัลกอริทึมที่มีความซับซ้อน
* คอมเมนต์ที่ให้บริบทเพิ่มเติมซึ่งไม่สามารถสื่อสารผ่านโค้ดได้โดยตรง

ตัวอย่างคอมเมนต์ที่เหมาะสม
```C#
// ใช้ Binary Search เพื่อลดเวลาในการค้นหาเป็น O(log n)
// เนื่องจากข้อมูลมีขนาดใหญ่มาก
```
คอมเมนต์ในลักษณะนี้ช่วยเพิ่มความเข้าใจให้กับผู้อ่านโค้ด และไม่ถือว่าเป็น code smell

## แหล่งอ้างอิง
* JetBrains. [Code Smells – Comments](https://www.jetbrains.com/pages/static-code-analysis-guide/code-smells/)
* PragTob. [Are Comments a Code Smell? Yes! No? It Depends.](https://pragtob.wordpress.com/2017/11/14/are-comments-a-code-smell-yes-no-it-depends/)
* Refactoring Guru. [Comments Code Smell](https://refactoring.guru/smells/comments)
